## Better-Auth CLI “can’t find module” when importing from `src/…`

### Original symptom

When running the Better-Auth CLI (`better-auth generate`), I got:

```txt
2025-06-13T14:06:52.993Z ERROR [Better Auth]: [#better-auth]: Couldn't read your auth config. Error: Cannot find module 'src/server/db/index'
Require stack:
- /…/my-chatbot/src/lib/auth.ts
…
    at jitiRequire (…/node_modules/jiti/dist/jiti.cjs:1:189288)
    at import (…/jiti/dist/jiti.cjs:1:199778)
    at /…/my-chatbot/src/lib/auth.ts:3:20
…
```

In that file I was doing:

```ts
// ✅ works under my Next.js build
import { db } from "~/server/db/index";

// ❌ breaks Better-Auth CLI with MODULE_NOT_FOUND
import { db } from "src/server/db/index";
```

I already have `~` aliased to `./src`, but I assumed plain `"src/…”` would “just work” since the folder is at the project root.

---

### How I dug into it

1. **JITI uses Node’s resolver at runtime**
   Better-Auth (via `jiti()`) only resolves modules when you actually call it, and it defaults to Node’s ESM/CJS lookup. It doesn’t know about my TS/SWC “bundler” aliases.

2. **TS + SWC “Bundler” mode is too forgiving**
   My Next.js setup uses

   ```jsonc
   "moduleResolution": "Bundler",
   "baseUrl": ".",
   "paths": { "~/*": ["src/*"] }
   ```

   Under **Bundler** mode, TypeScript just checks “hey, does any file match `src/server/db/index.ts`?” and yup—so it emits no error, and SWC happily compiles it for the browser.

3. **Mismatch between build-time vs. runtime**

   - **Build / dev server** (Next.js + SWC) resolves `"src/…”` → `./src/...`
   - **Better-Auth CLI** (jiti + Node resolver) sees `"src/…”` → fails at runtime

---

### The root cause

My TS config (and SWC) was operating in **Bundler** mode, which effectively defers all non-relative imports to “whatever the bundler does.” Since Next.js/SWC treat `src/` as a root, everything compiled fine. But JITI’s runtime lookup is pure Node-style, so plain `"src/…”` isn’t a valid Node path unless you teach it with a matching alias.

---

### What I decided to do

Since Better-Auth is only used in one small CLI slice of the app, I’m not going to overhaul my entire module-resolution setup. Instead:

1. **Let JITI error on `src/…` imports**
   I’ll keep using my `~` alias everywhere the browser needs it.

2. **Fix only the CLI imports**
   In `src/lib/auth.ts` (and any other CLI entrypoints), I’ll switch to either:

   ```ts
   import { db } from "~/server/db/index"; // my existing alias
   // or
   import { db } from "../server/db/index"; // explicit relative path
   ```

That way Better-Auth never tries to resolve a bare `"src/…”` import, and I avoid messing with the rest of my Next.js build.
